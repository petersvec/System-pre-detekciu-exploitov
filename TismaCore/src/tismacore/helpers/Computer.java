/*
 * Copyright (C) 2017 Lukas Lences
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
package tismacore.helpers;

import java.util.ArrayList;
import java.util.Date;
import java.util.HashSet;
import java.util.logging.Level;
import java.util.logging.Logger;
import weka.core.Attribute;
import weka.core.Instances;

/**
 *
 * @author Lukas Lences
 */
public class Computer {
    private final static Logger LOGGER = Logger.getLogger(TLogger.class.getName());
    static final long ONE_SECOND_IN_MILLIS = 1000;
    static final long ONE_MINUTE_IN_MILLIS = 60*1000;//millisecs
    static final int NUMBER_OF_CLUSTER_ATTRIBUTTES = 15;
    
    
    public static Date getEndTime(Date startTime, int seconds){
        return new Date(startTime.getTime() + 
                (seconds * ONE_SECOND_IN_MILLIS));
    }
    
     public static Instances createInstancesStructureClustering(HashSet<String> uniqueSourceIp) {
        LOGGER.log(Level.FINE, "Preparing dataset for clustering.");
        Instances dataset = null;
        ArrayList<String> fvNominalVal = new ArrayList<>();
        fvNominalVal.addAll(uniqueSourceIp);
       /* ArrayList<String> fvNominalClass = new ArrayList<>();
        fvNominalClass.add("botnet");
        fvNominalClass.add("other");*/

        Attribute att1 = new Attribute("SrcIp", fvNominalVal);
        Attribute att2 = new Attribute("u_spport");
        Attribute att3 = new Attribute("u_dip");
        Attribute att4 = new Attribute("u_dport");
        Attribute att5 = new Attribute("nNf");
        Attribute att6 = new Attribute("nBts");
        Attribute att7 = new Attribute("nPckts");
       // Attribute att8 = new Attribute("class", fvNominalClass);

        ArrayList<Attribute> attributes = new ArrayList<>();
        attributes.add(att1);
        attributes.add(att2);
        attributes.add(att3);
        attributes.add(att4);
        attributes.add(att5);
        attributes.add(att6);
        attributes.add(att7);
       // attributes.add(att8);

        dataset = new Instances("TismaClusterDataset", attributes, 0);
        
        return dataset;
    }
     
     public static Instances createInstancesStructureForJRIP(){
        Instances dataset = null;
         ArrayList<String> fvNominalVal = new ArrayList<String>();
        fvNominalVal.add("botnet");
        fvNominalVal.add("other");
        
        Attribute[] att = new Attribute[NUMBER_OF_CLUSTER_ATTRIBUTTES+1];
        att[0] = new Attribute("nInstancesInCluster");
        att[1] = new Attribute("nNetFlows");
        att[2] = new Attribute("nSip");
        att[3] = new Attribute("avg_nSP");
        att[4] = new Attribute("stdDev_nSP");
        att[5] = new Attribute("avg_nDip");
        att[6] = new Attribute("stdDev_nDip");
        att[7] = new Attribute("avg_nDP");
        att[8] = new Attribute("stdDev_nDP");
        att[9] = new Attribute("avg_nNF");
        att[10] = new Attribute("stdDev_nNF");
        att[11] = new Attribute("avg_nBytes");
        att[12] = new Attribute("stdDev_nBytes");
        att[13] = new Attribute("avg_nPackets");
        att[14] = new Attribute("stdDev_nPackets");
        att[15] = new Attribute("Class", fvNominalVal);
        
        ArrayList<Attribute> attributes = new ArrayList<>();
        for (int i = 0; i <= NUMBER_OF_CLUSTER_ATTRIBUTTES; i++) {
            attributes.add(att[i]);
        }
        
        dataset = new Instances("ClusterDataset", attributes, 0);
        return dataset;
     }
}
